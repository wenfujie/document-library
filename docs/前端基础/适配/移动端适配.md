## amfe-flexible 和 postcss-pxtorem 方案

- [amfe-flexible](https://github.com/amfe/lib-flexible?tab=readme-ov-file)库可以自动计算 html 根节点的字体大小。
- [postcss-pxtorem](https://github.com/cuth/postcss-pxtorem) 插件，可以将 px 单位转换成 rem 单位

### 使用

```bash
npm i amfe-flexible -S
npm i postcss-pxtorem -D
```

main.js 中引入

```bash
import 'amfe-flexible'
```

html 文件添加标签

```html
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
/>
```

根目录新加文件 `postcss.config.js`

```js
module.exports = {
  plugins: {
    'postcss-pxtorem': {
      // 如果是二倍图750px,则rootValue写 75，如果是一倍图375px,则写 37.5
      rootValue: 75,
      propList: ['*']
    }
  }
}
```

### 限制 pc 端放大比例

移动端要下放到 pc 去展示，若按照上述方案在大屏元素比例会放大太多从而导致页面比例失调。

解决：

1. 将页面展示内容设置为宽度 750px 且居中显示，两边留白。
2. 将调整根节点字体大小方案限制为 2 倍，代码为如下

```js
function setRem() {
  const baseSize = 50
  const scale = document.documentElement.clientWidth / 375
  // 设置页面根节点字体大小最高放大比例为2，可根据实际业务需求调整）
  document.documentElement.style.fontSize = baseSize * Math.min(scale, 2) + 'px'
}

setRem()
window.onresize = function () {
  setRem()
}
```
