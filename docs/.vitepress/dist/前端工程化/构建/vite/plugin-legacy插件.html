<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vite 插件 @vitejs/plugin-legacy | wfj blog</title>
    <meta name="description" content="wfj的笔记">
    <meta name="generator" content="VitePress v1.1.3">
    <link rel="preload stylesheet" href="/assets/style.BejYGQg3.css" as="style">
    
    <script type="module" src="/assets/app.D11Z9D95.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.CukXLko6.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Bek_Mmwg.js">
    <link rel="modulepreload" href="/assets/前端工程化_构建_vite_plugin-legacy插件.md.GByGDc0t.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1b335259><!--[--><!--]--><!--[--><span tabindex="-1" data-v-87f5e53e></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-87f5e53e> Skip to content </a><!--]--><!----><header class="VPNav" data-v-1b335259 data-v-13f2fa35><div class="VPNavBar top" data-v-13f2fa35 data-v-55f069a0><div class="wrapper" data-v-55f069a0><div class="container" data-v-55f069a0><div class="title" data-v-55f069a0><div class="VPNavBarTitle" data-v-55f069a0 data-v-22b98ef9><a class="title" href="/" data-v-22b98ef9><!--[--><!--]--><!----><span data-v-22b98ef9>wfj blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-55f069a0><div class="content-body" data-v-55f069a0><!--[--><!--]--><div class="VPNavBarSearch search" data-v-55f069a0><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-55f069a0 data-v-54989f0e><span id="main-nav-aria-label" class="visually-hidden" data-v-54989f0e>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-54989f0e data-v-84bac59e><!--[--><span data-v-84bac59e>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/html/html%E9%9D%A2%E8%AF%95%E9%A2%98.html" tabindex="0" data-v-54989f0e data-v-84bac59e><!--[--><span data-v-84bac59e>前端基础</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-55f069a0 data-v-2549cd6e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-2549cd6e data-v-6dfe3a2f data-v-9599ff10><span class="check" data-v-9599ff10><span class="icon" data-v-9599ff10><!--[--><span class="vpi-sun sun" data-v-6dfe3a2f></span><span class="vpi-moon moon" data-v-6dfe3a2f></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-55f069a0 data-v-21931765 data-v-70c67f6c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-70c67f6c data-v-263c3682><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-55f069a0 data-v-641c2a9b data-v-3a407355><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-3a407355><span class="vpi-more-horizontal icon" data-v-3a407355></span></button><div class="menu" data-v-3a407355><div class="VPMenu" data-v-3a407355 data-v-a8014fba><!----><!--[--><!--[--><!----><div class="group" data-v-641c2a9b><div class="item appearance" data-v-641c2a9b><p class="label" data-v-641c2a9b>Appearance</p><div class="appearance-action" data-v-641c2a9b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-641c2a9b data-v-6dfe3a2f data-v-9599ff10><span class="check" data-v-9599ff10><span class="icon" data-v-9599ff10><!--[--><span class="vpi-sun sun" data-v-6dfe3a2f></span><span class="vpi-moon moon" data-v-6dfe3a2f></span><!--]--></span></span></button></div></div></div><div class="group" data-v-641c2a9b><div class="item social-links" data-v-641c2a9b><div class="VPSocialLinks social-links-list" data-v-641c2a9b data-v-70c67f6c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-70c67f6c data-v-263c3682><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-55f069a0 data-v-70dd5365><span class="container" data-v-70dd5365><span class="top" data-v-70dd5365></span><span class="middle" data-v-70dd5365></span><span class="bottom" data-v-70dd5365></span></span></button></div></div></div></div><div class="divider" data-v-55f069a0><div class="divider-line" data-v-55f069a0></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-1b335259 data-v-486cd82a><div class="container" data-v-486cd82a><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-486cd82a data-v-862199b8><button data-v-862199b8>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-1b335259 data-v-8503ca8c><div class="VPDoc has-aside" data-v-8503ca8c data-v-ef43d1f7><!--[--><!--]--><div class="container" data-v-ef43d1f7><div class="aside" data-v-ef43d1f7><div class="aside-curtain" data-v-ef43d1f7></div><div class="aside-container" data-v-ef43d1f7><div class="aside-content" data-v-ef43d1f7><div class="VPDocAside" data-v-ef43d1f7 data-v-4c5d724a><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-4c5d724a data-v-7c862d68><div class="content" data-v-7c862d68><div class="outline-marker" data-v-7c862d68></div><div class="outline-title" role="heading" aria-level="2" data-v-7c862d68>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-7c862d68><span class="visually-hidden" id="doc-outline-aria-label" data-v-7c862d68> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-7c862d68 data-v-f3f6788e><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-4c5d724a></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-ef43d1f7><div class="content-container" data-v-ef43d1f7><!--[--><!--]--><main class="main" data-v-ef43d1f7><div style="position:relative;" class="vp-doc _%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96_%E6%9E%84%E5%BB%BA_vite_plugin-legacy%E6%8F%92%E4%BB%B6" data-v-ef43d1f7><div><ul><li><a href="#vite-插件-vitejsplugin-legacy">Vite 插件 @vitejs/plugin-legacy</a><ul><li><a href="#什么是-polyfillbabel">什么是 polyfill、babel</a></li><li><a href="#什么是传统浏览器">什么是传统浏览器</a></li><li><a href="#为传统浏览器生成-polyfill">为传统浏览器生成 polyfill</a><ul><li><a href="#指定要兼容的浏览器版本---targets">指定要兼容的浏览器版本 - targets</a></li><li><a href="#指定特性范围---polyfills">指定特性范围 - polyfills</a></li><li><a href="#打包效果">打包效果</a></li></ul></li></ul></li></ul><h1 id="vite-插件-vitejs-plugin-legacy" tabindex="-1">Vite 插件 @vitejs/plugin-legacy <a class="header-anchor" href="#vite-插件-vitejs-plugin-legacy" aria-label="Permalink to &quot;Vite 插件 @vitejs/plugin-legacy&quot;">​</a></h1><p><a href="https://github.com/vitejs/vite/tree/main/packages/plugin-legacy" target="_blank" rel="noreferrer">@vitejs/plugin-legacy 官网</a></p><blockquote><p>Vite 默认打包的 runtime 依赖原生 esm，但在一些老的系统或浏览器原生不支持 esm 的，这个时候就需要用到该插件。</p></blockquote><p>该插件作用是为传统浏览器 js 代码提供兼容性支持。</p><h2 id="什么是-polyfill、babel" tabindex="-1">什么是 polyfill、babel <a class="header-anchor" href="#什么是-polyfill、babel" aria-label="Permalink to &quot;什么是 polyfill、babel&quot;">​</a></h2><blockquote><p>babel: 只负责代码转换，将旧的语法转换为新的语法。</p></blockquote><blockquote><p>polyfill: 也称为代码垫片，负责新特性的功能实现。</p></blockquote><p>所以代码兼容一般由 babel + polyfill 一起实现。</p><h2 id="什么是传统浏览器" tabindex="-1">什么是传统浏览器 <a class="header-anchor" href="#什么是传统浏览器" aria-label="Permalink to &quot;什么是传统浏览器&quot;">​</a></h2><blockquote><p>传统浏览器一般指不支持 native ESM 的浏览器，如 chrome&lt;60，Edge&lt;15，Firefox&lt;59 等等，如果使用 vite 打包而不做任何的处理的话，是无法在这些浏览器上面运行的，因为打包出来的代码使用了 js 新的规范。</p></blockquote><h2 id="为传统浏览器生成-polyfill" tabindex="-1">为传统浏览器生成 polyfill <a class="header-anchor" href="#为传统浏览器生成-polyfill" aria-label="Permalink to &quot;为传统浏览器生成 polyfill&quot;">​</a></h2><h3 id="指定要兼容的浏览器版本-targets" tabindex="-1">指定要兼容的浏览器版本 - targets <a class="header-anchor" href="#指定要兼容的浏览器版本-targets" aria-label="Permalink to &quot;指定要兼容的浏览器版本 - targets&quot;">​</a></h3><p><code>targets: string | string[] | { [key: string]: string }</code> 属性指定要兼容的浏览器版本、系统版本，默认值：&#39;last 2 versions and not dead, &gt; 0.3%, Firefox ESR&#39;，通常使用 <a href="https://github.com/browserslist/browserslist" target="_blank" rel="noreferrer">Browserslist</a> 语法来配置。可通过 <a href="https://browserslist.dev/?q=bGFzdCAyIHZlcnNpb25z" target="_blank" rel="noreferrer">browserslist.dev</a>查看值对应了哪些浏览器版本。</p><p>以下是 browserslist 的最佳实践，减轻配置负担。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 现代浏览器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">last </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> versions and since </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2018</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> and </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 兼容低版本 PC 浏览器</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">IE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, not dead</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 兼容低版本移动端浏览器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iOS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Android </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, last </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> versions, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, not dead</span></span></code></pre></div><h3 id="指定特性范围-polyfills" tabindex="-1">指定特性范围 - polyfills <a class="header-anchor" href="#指定特性范围-polyfills" aria-label="Permalink to &quot;指定特性范围 - polyfills&quot;">​</a></h3><p><code>polyfills: boolean | string[]</code> 属性指定要针对哪些特性生成 polyfill ，一般默认为 true 即可，可选值：</p><ul><li>true(默认)，对所有使用到的代码进行检测生成。（底层通过@babel/preset-env 的 useBuiltIns: &#39;usage&#39;检测）</li><li>string[]，指定新特性范围列表。可选值见<a href="https://github.com/vitejs/vite/tree/main/packages/plugin-legacy#polyfill-specifiers" target="_blank" rel="noreferrer">polyfill-specifiers</a></li></ul><h3 id="打包效果" tabindex="-1">打包效果 <a class="header-anchor" href="#打包效果" aria-label="Permalink to &quot;打包效果&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> legacy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@vitejs/plugin-legacy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  plugins: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    legacy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // ie 不低于 11 版本，全球超过 0.5% 使用，且还在维护更新的浏览器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      targets: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ie &gt;= 11, &gt; 0.5%, not dead&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      polyfills: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><p>打包后，多出了 index-legacy.js、vendor-legacy.js 以及 polyfills-legacy.js 三份产物文件，index.html 也有变化</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;!</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">DOCTYPE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">html</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;en&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">head</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">meta</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> charset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UTF-8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;icon&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;image/svg+xml&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/assets/favicon.17e50649.svg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">meta</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;viewport&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> content</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;width=device-width, initial-scale=1.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Vite App&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- 1. Modern 模式产物 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;module&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> crossorigin</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/assets/index.c1383506.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modulepreload&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/assets/vendor.0f99bfcc.js&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">link</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> rel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stylesheet&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> href</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/assets/index.91183920.css&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">head</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">div</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    &lt;!-- 2. Legacy 模式产物 --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nomodule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      兼容 iOS nomodule 特性的 polyfill，省略具体代码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      nomodule</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vite-legacy-polyfill&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/assets/polyfills-legacy.36fe2f9e.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      nomodule</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vite-legacy-entry&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      data-src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/assets/index-legacy.c3d3f501.js&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      System.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getElementById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vite-legacy-entry&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getAttribute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data-src&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">body</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">html</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>通过官方的 legacy 插件， Vite 会分别打包出 Modern 模式和 Legacy 模式的产物，然后将两种产物插入同一个 HTML 里面，Modern 产物被放到 type=&quot;module&quot;的 script 标签中，而 Legacy 产物则被放到带有 nomodule 的 script 标签中。</p><p><img src="/assets/nomodule%E5%8A%A0%E8%BD%BD%E7%AD%96%E7%95%A5.DkQJsjjx.png" alt="nomodule加载策略"></p><p>这样产物便就能够同时放到现代浏览器和不支持 type=&quot;module&quot;的低版本浏览器当中执行。</p></div></div></main><footer class="VPDocFooter" data-v-ef43d1f7 data-v-9c5fc074><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api-examples.md\":\"BaVVg2GK\",\"markdown-examples.md\":\"DxvejM6l\",\"前端业务_h5拖拽_拖拽.md\":\"BXU4UKeF\",\"index.md\":\"DCNcCsUG\",\"前端业务_权限控制.md\":\"DJqMlh4L\",\"前端业务_压缩文件并下载.md\":\"B8P_vO-j\",\"前端业务_各种业务解决方案.md\":\"BVHr9Vnx\",\"前端业务_系统选择文件弹窗_index.md\":\"DYIl_b77\",\"前端基础_css_盒模型及bfc.md\":\"KB3H5ZMf\",\"前端基础_css_有趣的css.md\":\"BsBtow5r\",\"前端基础_css_自适应和响应式布局.md\":\"Cl1JyITy\",\"前端基础_html_html面试题.md\":\"CNqWv0Lb\",\"前端基础_js_es6_esm_esm和commonjs.md\":\"BobKM8n1\",\"前端基础_html_h5开发faq.md\":\"bGxdMP1l\",\"前端基础_css_面试题.md\":\"6v6Y6Iul\",\"前端基础_js_es6_promise_介绍和实现.md\":\"CnThVHhj\",\"前端基础_js_基础_this指向.md\":\"KFShqF5y\",\"前端基础_js_函数式编程_函数式编程new.md\":\"3W9YOpwE\",\"前端基础_js_函数式编程_函数式编程.md\":\"C8EGUSBn\",\"前端基础_js_es6_类.md\":\"A_437FDU\",\"前端基础_js_基础_事件循环.md\":\"DsvUs4gc\",\"前端基础_js_基础_对象_深拷贝.md\":\"DZUW-T6C\",\"前端基础_js_es6_新特性.md\":\"gfsAjdEz\",\"前端基础_js_基础_原型链.md\":\"DMfB3yOV\",\"前端基础_js_基础_遍历.md\":\"BCZEAtl2\",\"前端基础_js_基础_数据类型_数据类型的转换.md\":\"BDZsPept\",\"前端基础_js_基础_数组_扁平化.md\":\"CagZlvdI\",\"前端基础_js_封装_防抖与节流_index.md\":\"DkyQdMVf\",\"前端基础_浏览器_bom.md\":\"C2-ADerP\",\"前端基础_js_基础_数据类型_数据类型的判断.md\":\"CyxeoZcW\",\"前端基础_适配_页面适配.md\":\"CR7SQzaG\",\"前端基础_js_基础_闭包.md\":\"rZCkHidx\",\"前端基础_浏览器_dom事件总结.md\":\"DfkeB_X_\",\"前端基础_浏览器_谷歌浏览器开发者工具.md\":\"92PbFZ72\",\"前端基础_浏览器_浏览器渲染机制.md\":\"EyhYC0AJ\",\"前端工程化_代码规范_eslint_prettier.md\":\"Kgdn2AH_\",\"前端基础_浏览器_v8引擎的垃圾回收.md\":\"DBEPiovs\",\"前端基础_代码规范_变量命名.md\":\"BrY29cRJ\",\"前端工程化_代码规范_husky约束commit规范.md\":\"CSCGCyZp\",\"前端基础_适配_pc适配.md\":\"DGFMv3ko\",\"前端工程化_开发_git使用.md\":\"CtHWxoJ2\",\"前端工程化_开发_pnpm介绍.md\":\"Bpe_V9pn\",\"前端工程化_开发_常用vscode插件.md\":\"DjY02avf\",\"前端工程化_开发_npm使用.md\":\"CGFtWDEr\",\"前端工程化_开发_vscode快捷键和终端指令.md\":\"fyyJxk1Y\",\"前端工程化_开发_脚手架_commander使用.md\":\"D2YdiM2D\",\"前端工程化_构建_vite_catalog.md\":\"DtSt8mLB\",\"前端工程化_构建_babel_polyfill浏览器兼容.md\":\"CnYgJ9ov\",\"前端工程化_开发_脚手架_搭建脚手架.md\":\"BCOOyDF4\",\"前端工程化_构建_babel7.md\":\"BcLZ2dd-\",\"前端工程化_构建_vite_vite为何冷启动、热更快.md\":\"rLbig_vQ\",\"前端工程化_构建_vite_什么是预构建.md\":\"_LpzEoYD\",\"前端工程化_构建_vite_plugin-legacy插件.md\":\"GByGDc0t\",\"前端工程化_构建_vite_构建拆包.md\":\"BMcTiepY\",\"前端工程化_构建_webpack_loader.md\":\"D-v4Opo7\",\"前端工程化_构建_vite_插件.md\":\"LN3JZ4oy\",\"前端工程化_测试_端到端测试.md\":\"DDdbgOd8\",\"前端工程化_部署_docker使用说明.md\":\"DnZwnPkz\",\"前端工程化_构建_webpack_热更新原理.md\":\"AjT2vQ7J\",\"前端工程化_构建_webpack_介绍.md\":\"DWJcgPsx\",\"前端工程化_部署_gitlab-ci.md\":\"Bennnp9M\",\"前端工程化_部署_nginx指南.md\":\"D3b9tOfh\",\"前端工程化_部署_node自动化部署.md\":\"DSnB4Xta\",\"前端性能优化_webpack打包优化.md\":\"CJkr-vJO\",\"前端性能优化_如何提升用户体验.md\":\"2fUjl-aN\",\"前端性能优化_性能优化.md\":\"DJjRHQf9\",\"前端架构_对bff的理解.md\":\"DyaCDWEF\",\"前端架构_大仓库_lerna.md\":\"CH94pgtc\",\"前端架构_跨平台方案.md\":\"BD53W0Ri\",\"前端框架_ts_介绍.md\":\"BmEMiZDE\",\"前端框架_nuxt_nuxt服务端渲染.md\":\"CggVyvgH\",\"前端框架_ts_实战.md\":\"CBqr_eDZ\",\"前端框架_ts_常用配置.md\":\"BKvtP09v\",\"前端框架_ts_类型.md\":\"1sj4gMI3\",\"前端框架_ts_类型工具.md\":\"DRphqqAH\",\"前端框架_ts_编写声明文件.md\":\"Ddufs8Hr\",\"前端框架_vue2_vue-cli使用说明.md\":\"BpBOdRJZ\",\"前端框架_vue2_vue中key的作用.md\":\"CXgkRSJN\",\"前端框架_vue2_vue和react横向对比.md\":\"CI6kf4BJ\",\"前端框架_vue2_vue中的渲染函数_jsx.md\":\"BOW3GSzh\",\"前端框架_vue2_vue组件.md\":\"CrHN7-bB\",\"前端框架_vue2_vui_static_temp_readme.md\":\"GS3U0KxZ\",\"前端框架_vue2_vue高级特性.md\":\"nH_21KBT\",\"前端框架_vue2_vue原理.md\":\"JXGR6TXE\",\"前端框架_vue2_异步更新和nexttick.md\":\"CdRUVX3u\",\"前端框架_vue3_vue3开发注意事项.md\":\"m8KI24KS\",\"前端框架_vue3_vue3设计和原理_vue3做了哪些优化.md\":\"rs_RquPh\",\"前端框架_vue3_vue3快速上手.md\":\"BLGvqiwP\",\"前端框架_vue3_vue3设计和原理_reactive_proxy的工作原理.md\":\"2DqR2j1b\",\"前端框架_vue3_vue3设计和原理_computed实现.md\":\"dECrHPiB\",\"前端框架_vue3_vue3设计和原理_reactive_ref原始值的响应式.md\":\"BXJNibxb\",\"前端框架_vue3_vue3设计和原理_reactive_响应系统的设计.md\":\"C30yY-GO\",\"前端框架_vue3_vue3设计和原理_renderer_初始化组件实例过程.md\":\"Cy4cP0C4\",\"前端生态_库_vueuse快速上手.md\":\"BFRRIFUr\",\"前端框架_vue3_vue3设计和原理_renderer_组件渲染成dom的过程.md\":\"DKrYibFN\",\"前端框架_vue3_vue3设计和原理_renderer_渲染器的设计.md\":\"BuuLLS_9\",\"前端生态_库_lodash常用函数.md\":\"D8Bnohj-\",\"前端进阶_安全_csp内容安全策略.md\":\"CSdofNgH\",\"前端进阶_动画_css动画.md\":\"CPTWtYZN\",\"前端进阶_安全_csrf和xss.md\":\"DUFOZDGB\",\"前端进阶_手写代码_index.md\":\"DMl7Ov77\",\"前端进阶_安全_加密和签名.md\":\"H7anP-KK\",\"前端进阶_手写代码_js小技巧.md\":\"0OA5NKVQ\",\"前端进阶_手写代码_写代码小技巧.md\":\"hijbw2oV\",\"生活_书籍_亲密关系.md\":\"DvhyOmLc\",\"生活_书籍_刻意练习.md\":\"B6nTh1B6\",\"生活_书籍_人生的智慧.md\":\"MJI0VuVS\",\"生活_书籍_如何阅读一本书.md\":\"BLltDUMy\",\"生活_书籍_小狗钱钱.md\":\"D3XN2RB3\",\"生活_书籍_超级闲聊术.md\":\"DJRFn9bq\",\"生活_书籍_金字塔原理.md\":\"55cTqQRd\",\"生活_心理学_需求层次理论.md\":\"-sfsCtxo\",\"生活_积累_沟通.md\":\"RwCGt25z\",\"生活_积累_良句.md\":\"BPKLNWy7\",\"生活_随想_催眠自己去跑步的文章.md\":\"DNfzP25D\",\"生活_随想_小事记录.md\":\"BvdafzTH\",\"程序员储备_开发语言_markdown_demo_assets_test.md\":\"QAv2xbHy\",\"生活_随想_零碎想法.md\":\"Cupw6ONN\",\"程序员储备_开发语言_markdown_markdown语法.md\":\"rst_DVLU\",\"前端进阶_手写代码_js代码片段.md\":\"Df3UGTAr\",\"程序员储备_开发语言_markdown_markdown转html.md\":\"Bob4MY8Q\",\"程序员储备_开发语言_shell脚本编写.md\":\"UOmWipCl\",\"程序员储备_正则_学习正则表达式.md\":\"CQSxB9fx\",\"程序员储备_正则_正则mini书笔记.md\":\"BvztOG3D\",\"程序员储备_算法_基础算法.md\":\"opuL3Zh9\",\"网络请求_本地域名映射.md\":\"BHk7LAyN\",\"面试_与面试官的较量.md\":\"WVtgjQyu\",\"网络请求_http_http协议.md\":\"Dxzehe09\",\"面试_做好面试官.md\":\"DHnLmnQB\",\"网络请求_跨域资源共享cors.md\":\"Wa9dEMSK\",\"网络请求_跨域解决方案.md\":\"CjjF_Rk1\",\"程序员储备_设计模式_设计模式.md\":\"CE4xxtXk\",\"面试_学习规划.md\":\"1xowEAxT\",\"面试_前端面试资源汇总.md\":\"SwjRUG5m\",\"程序员储备_算法_算法深入.md\":\"Cqrr1rsT\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"wfj blog\",\"description\":\"wfj的笔记\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"前端基础\",\"link\":\"/前端基础/html/html面试题\"}],\"sidebar\":{\"/前端基础/\":[{\"text\":\"html\",\"items\":[{\"text\":\"html面试题\",\"link\":\"/前端基础/html/html面试题\"},{\"text\":\"H5开发FAQ\",\"link\":\"/前端基础/html/H5开发FAQ\"}]},{\"text\":\"css\",\"items\":[{\"text\":\"盒模型及BFC\",\"link\":\"/前端基础/css/盒模型及BFC\"},{\"text\":\"面试题\",\"link\":\"/前端基础/css/面试题\"},{\"text\":\"有趣的css\",\"link\":\"/前端基础/css/有趣的css\"},{\"text\":\"自适应和响应式布局\",\"link\":\"/前端基础/css/自适应和响应式布局\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>