
## 前言
### 相关技术栈和依赖
- javascript
- 发布 npm 包。不熟悉如何发布的可看我之前的文章 [npm详细使用说明](https://github.com/wenfujie/document-library/blob/master/articles/%E5%B7%A5%E5%85%B7/npm%E8%AF%A6%E7%BB%86%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E.md#%E5%8F%91%E5%B8%83-npm-%E5%8C%85)
- commander 包的使用

### 分析

脚手架 ```vue-cli``` 相信大家都使用过，很便捷。
```bash
# 全局安装 vue cli 包
npm install -g @vue/cli-service-global

# 使用vue cli 内置指令创建一个工程
vue create hello-world

# 运行项目
cd hello-world
npm i
npm run dev
```
几个指令就搭建好一个前端工程。

**这边文章目的是教会大家如何发布个人的脚手架。**

主要分为以下步骤：
- 部署自己的 npm 包
- 全局安装包后，支持使用我们自定义的指令
- 配置好一个前端工程，并推送到git代码库
- 根据指令触发，拉取代码仓库到本地

## 发布 npm 包，支持使用指令
**没有发布 npm 包经验的同学看这里：**[发布 npm 包](https://github.com/wenfujie/document-library/blob/master/articles/%E5%B7%A5%E5%85%B7/npm%E8%AF%A6%E7%BB%86%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E.md#%E5%8F%91%E5%B8%83-npm-%E5%8C%85)

**发布的包如何像以下这样，支持使用指令？**
```bash
vue create hello-world
```

**第一步：指令配置**

在包的 package.json 文件增加以下指令配置
```json
// package.json
{
  ...
  // bin 用于配置指令。
  "bin": {
    // key 为指令名， value 为要执行的文件。
    "wfj-cli": "./index.js"
  },
  ...
}
```
```bin``` 用于配置指令，指令由 `key` 和 `value` 组成，`key` 为指令名，`vaule` 为运行指令后要执行的文件。

**第二步：修改要执行的文件**

`index.js`
```javascript
#!/usr/bin/env node

console.log('hello world')
```
可以看到在 `index.js` 的首行为 `#!/usr/bin/env node` 。
该行作用为使用系统下的 env 文件找到 node 安装位置，并使用 node 执行该文件。

**第三步：重新部署并全局安装使用**

重新部署 npm 包后，再全局安装
```bash
npm i -g packName
```
使用指令
```bash
# 理论上执行了 node index.js
wfj-cli

# 执行结果
hello world
```
到这里，我们已经成功发布一个支持使用简单指令的 npm 包了，它只能根据指令去执行对应的文件。

**如何处理更复杂的指令？**

- 像 vue cli 这样，接收到指令上的参数`'hello-world'` 作为创建文件夹的名称
```bash
vue create hello-world
```
- 提供多个选项供用户选择，根据用户选择做不同的处理
![](images/cli-select-features.png)

让我们接着往下走。

## commander 包的使用
>`commander` 是一个 npm 包，是完整的 node.js 命令行解决方案。

使用 `commander` 可以完美解决接收指令参数、提供指令选项、设置多个子指令等问题。

想快速上手使用，可以看我整理的使用概览：[commander 包使用说明]()

更深入的学习请前往：[官方使用说明](https://github.com/tj/commander.js/blob/HEAD/Readme_zh-CN.md)